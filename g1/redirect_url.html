<html>
<body>
<script>
if (typeof window !== 'undefined' && window.location.search) {
  const searchParams = new URLSearchParams(window.location.search);
  const code = searchParams.get('code');
  if (code) {
    const params = {
      client_id: '51571302',
      client_secret: 'Защищённый ключ приложения',
      redirect_uri: 'https://hoochiecoo.github.io/test/g1/redirect_url2',
      code: code //Код полученный от VK
    };
    const url = 'https://oauth.vk.com/access_token?' + decodeURIComponent(new URLSearchParams(params).toString());
    fetch(url)
      .then(response => response.json())
      .then(data => {
        if (data.access_token) {
          if (data.email) {
            //Выполняем авторизацию пользователя по email
          }
        }
      })
      .catch(error => console.error(error));
  }
}

</script>

</body>
</html>
